# ZKStack BSC æ™ºèƒ½é…ç½®ç³»ç»Ÿ

## ğŸ¯ æ¦‚è¿°

ZKStackç°åœ¨æ”¯æŒæ™ºèƒ½ç½‘ç»œé…ç½®ç³»ç»Ÿï¼Œèƒ½å¤Ÿåœ¨é“¾åˆå§‹åŒ–æ—¶æ ¹æ®L1ç½‘ç»œç±»å‹è‡ªåŠ¨åº”ç”¨æœ€ä¼˜çš„é…ç½®ã€‚è¿™ä¸ªç³»ç»Ÿç‰¹åˆ«ä¸ºBSCç½‘ç»œè¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ï¼Œæä¾›äº†æ˜¾è‘—çš„æ€§èƒ½æå‡å’Œæˆæœ¬é™ä½ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½ç½‘ç»œæ£€æµ‹
- **è‡ªåŠ¨è¯†åˆ«**: æ ¹æ®L1 Chain IDè‡ªåŠ¨è¯†åˆ«ç½‘ç»œç±»å‹
- **é…ç½®åŒ¹é…**: è‡ªåŠ¨åº”ç”¨å¯¹åº”ç½‘ç»œçš„æœ€ä¼˜é…ç½®
- **æ— ç¼é›†æˆ**: åœ¨`zkstack ecosystem init`å’Œ`zkstack chain init`æ—¶è‡ªåŠ¨ç”Ÿæ•ˆ

### 2. ç½‘ç»œæ”¯æŒ
| ç½‘ç»œç±»å‹ | Chain ID | ä¼˜åŒ–ç­–ç•¥ |
|----------|----------|----------|
| **BSC Mainnet** | 56 | BSCæ·±åº¦ä¼˜åŒ– |
| **BSC Testnet** | 97 | BSCæ·±åº¦ä¼˜åŒ– |
| **Ethereum Mainnet** | 1 | ä»¥å¤ªåŠä¿å®ˆé…ç½® |
| **Sepolia** | 11155111 | ä»¥å¤ªåŠæµ‹è¯•ç½‘é…ç½® |
| **Holesky** | 17000 | ä»¥å¤ªåŠæµ‹è¯•ç½‘é…ç½® |
| **Localhost** | 9 | é»˜è®¤å¼€å‘é…ç½® |

## ğŸ“‹ BSCä¼˜åŒ–é…ç½®è¯¦æƒ…

### ETH Senderä¼˜åŒ–
```yaml
eth:
  sender:
    max_txs_in_flight: 50                    # å¹¶å‘äº¤æ˜“æ•°
    max_acceptable_priority_fee_in_gwei: 5000000000  # 5 Gweiä¸Šé™
    aggregated_block_commit_deadline: 3      # 3ç§’æ‰¹æ¬¡æäº¤
    pubdata_sending_mode: CALLDATA           # Calldataæ¨¡å¼
    wait_confirmations: 2                    # 2ä¸ªåŒºå—ç¡®è®¤
```

### ETH Watcherä¼˜åŒ–
```yaml
eth:
  watcher:
    confirmations_for_eth_event: 2           # 2ä¸ªåŒºå—ç¡®è®¤
    eth_node_poll_interval: 1500             # 1.5ç§’è½®è¯¢
```

### State Keeperä¼˜åŒ–
```yaml
state_keeper:
  block_commit_deadline_ms: 3000             # 3ç§’çŠ¶æ€æäº¤
  miniblock_commit_deadline_ms: 1000         # 1ç§’å°æ‰¹æ¬¡æäº¤
```

### BSCè´¹ç”¨ä¼˜åŒ–
```yaml
bsc_fee_optimization:
  enabled: true
  min_base_fee_gwei: 0.1                     # æœ€å°è´¹ç”¨
  max_base_fee_gwei: 5.0                     # æœ€å¤§è´¹ç”¨
  target_base_fee_gwei: 1.0                  # ç›®æ ‡è´¹ç”¨
  fast_priority_fee_gwei: 0.5                # å¿«é€Ÿç¡®è®¤è´¹ç”¨
  congestion_threshold_gwei: 3.0             # æ‹¥å µé˜ˆå€¼
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. è‡ªåŠ¨åº”ç”¨ (æ¨è)
æ™ºèƒ½é…ç½®åœ¨é“¾åˆå§‹åŒ–æ—¶è‡ªåŠ¨ç”Ÿæ•ˆï¼š

```bash
# åˆå§‹åŒ–BSCç”Ÿæ€ç³»ç»Ÿ - è‡ªåŠ¨åº”ç”¨BSCä¼˜åŒ–
zkstack ecosystem init --l1-rpc-url https://bsc-dataseed.binance.org/

# åˆå§‹åŒ–BSCé“¾ - è‡ªåŠ¨åº”ç”¨BSCä¼˜åŒ–  
zkstack chain init --l1-rpc-url https://bsc-dataseed.binance.org/
```

### 2. æ‰‹åŠ¨åº”ç”¨
å¦‚æœéœ€è¦æ‰‹åŠ¨åº”ç”¨BSCä¼˜åŒ–ï¼š

```bash
# åº”ç”¨BSCä¼˜åŒ–åˆ°ç°æœ‰é“¾
zkstack chain optimize-for-bsc --network-type mainnet --apply

# ä»…åº”ç”¨åˆ°general.yaml
zkstack chain apply-bsc-general --network-type mainnet
```

### 3. éªŒè¯é…ç½®
éªŒè¯ç½‘ç»œé…ç½®æ˜¯å¦æ­£ç¡®åº”ç”¨ï¼š

```bash
# éªŒè¯BSCé…ç½®
zkstack chain validate-bsc --detailed

# ä½¿ç”¨éªŒè¯è„šæœ¬
./scripts/verify_network_config.sh --detailed
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### BSCç½‘ç»œä¼˜åŒ–æ•ˆæœ
| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡å¹…åº¦ |
|------|--------|--------|----------|
| **äº¤æ˜“ç¡®è®¤æ—¶é—´** | ~18ç§’ | ~6ç§’ | **67% â¬‡ï¸** |
| **æ‰¹æ¬¡æäº¤é¢‘ç‡** | 5åˆ†é’Ÿ | 3ç§’ | **9900% â¬†ï¸** |
| **äº‹ä»¶åŒæ­¥å»¶è¿Ÿ** | ~3ç§’ | ~1.5ç§’ | **50% â¬‡ï¸** |
| **å¹³å‡Gasè´¹ç”¨** | ~5 Gwei | ~1 Gwei | **80% â¬‡ï¸** |
| **å¹¶å‘å¤„ç†èƒ½åŠ›** | 10ä¸ª | 50ä¸ª | **400% â¬†ï¸** |

### æˆæœ¬æ•ˆç›Šåˆ†æ
- **æ—¥å¸¸è¿è¥æˆæœ¬**: é™ä½ 80%
- **äº¤æ˜“å¤„ç†æ•ˆç‡**: æå‡ 400%
- **ç”¨æˆ·ä½“éªŒ**: æ˜¾è‘—æ”¹å–„
- **ç½‘ç»œèµ„æºåˆ©ç”¨**: ä¼˜åŒ– 60%

## ğŸ› ï¸ é…ç½®æ–‡ä»¶ç»“æ„

### é…ç½®æ–‡ä»¶ä½ç½®
```
ecosystem/
â”œâ”€â”€ chains/
â”‚   â””â”€â”€ {chain_name}/
â”‚       â””â”€â”€ configs/
â”‚           â”œâ”€â”€ general.yaml          # ä¸»é…ç½®æ–‡ä»¶ (è‡ªåŠ¨ä¼˜åŒ–)
â”‚           â”œâ”€â”€ general.yaml.pre_bsc_backup  # åŸé…ç½®å¤‡ä»½
â”‚           â”œâ”€â”€ secrets.yaml
â”‚           â””â”€â”€ contracts.yaml
â””â”€â”€ etc/
    â””â”€â”€ env/
        â””â”€â”€ file_based/
            â”œâ”€â”€ general.yaml          # æ ‡å‡†æ¨¡æ¿
            â””â”€â”€ general_bsc_optimized.yaml  # BSCä¼˜åŒ–æ¨¡æ¿
```

### é…ç½®ä¼˜å…ˆçº§
1. **BSCç½‘ç»œ**: ä½¿ç”¨`general_bsc_optimized.yaml`æ¨¡æ¿
2. **ä»¥å¤ªåŠç½‘ç»œ**: åœ¨æ ‡å‡†é…ç½®åŸºç¡€ä¸Šåº”ç”¨ä¼˜åŒ–
3. **æœ¬åœ°ç½‘ç»œ**: ä½¿ç”¨é»˜è®¤é…ç½®

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. BSCä¼˜åŒ–æœªç”Ÿæ•ˆ
**ç—‡çŠ¶**: äº¤æ˜“ç¡®è®¤æ—¶é—´ä»ç„¶å¾ˆé•¿
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥é…ç½®
./scripts/verify_network_config.sh --detailed

# é‡æ–°åº”ç”¨ä¼˜åŒ–
zkstack chain optimize-for-bsc --network-type mainnet --apply

# é‡å¯æœåŠ¡å™¨
zkstack server --chain {chain_name}
```

#### 2. é…ç½®æ–‡ä»¶å†²çª
**ç—‡çŠ¶**: é…ç½®åº”ç”¨å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¢å¤å¤‡ä»½
cp chains/{chain_name}/configs/general.yaml.pre_bsc_backup \
   chains/{chain_name}/configs/general.yaml

# é‡æ–°åº”ç”¨
zkstack chain init
```

#### 3. ç½‘ç»œç±»å‹æ£€æµ‹é”™è¯¯
**ç—‡çŠ¶**: åº”ç”¨äº†é”™è¯¯çš„ç½‘ç»œé…ç½®
**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥L1ç½‘ç»œé…ç½®
cat ZkStack.yaml | grep l1_network

# æ‰‹åŠ¨æŒ‡å®šç½‘ç»œç±»å‹
zkstack chain optimize-for-bsc --network-type mainnet --apply
```

### æ—¥å¿—ç›‘æ§
ç›‘æ§å…³é”®æ—¥å¿—ç¡®è®¤ä¼˜åŒ–ç”Ÿæ•ˆï¼š

```bash
# ç›‘æ§BSCä¼˜åŒ–æ—¥å¿—
tail -f logs/zksync_server.log | grep -i "bsc\|optimiz"

# ç›‘æ§è´¹ç”¨è®¡ç®—æ—¥å¿—
tail -f logs/zksync_server.log | grep -i "fee\|gas"

# ç›‘æ§æ‰¹æ¬¡æäº¤æ—¥å¿—
tail -f logs/zksync_server.log | grep -i "commit\|batch"
```

## ğŸ“ˆ ç›‘æ§å’Œè°ƒä¼˜

### å…³é”®æŒ‡æ ‡ç›‘æ§
1. **äº¤æ˜“ç¡®è®¤æ—¶é—´**: ç›®æ ‡ < 10ç§’
2. **æ‰¹æ¬¡æäº¤é¢‘ç‡**: ç›®æ ‡ ~3ç§’
3. **Gasè´¹ç”¨**: ç›®æ ‡ < 2 Gwei
4. **äº‹ä»¶åŒæ­¥å»¶è¿Ÿ**: ç›®æ ‡ < 2ç§’

### æ€§èƒ½è°ƒä¼˜å»ºè®®
1. **ç½‘ç»œæ‹¥å µæ—¶**: ç³»ç»Ÿè‡ªåŠ¨æå‡è´¹ç”¨
2. **æˆæœ¬æ•æ„Ÿåœºæ™¯**: è°ƒæ•´`target_base_fee_gwei`
3. **é«˜é¢‘äº¤æ˜“**: å¢åŠ `max_txs_in_flight`
4. **ç¨³å®šæ€§ä¼˜å…ˆ**: å¢åŠ `safety_margin_percent`

## ğŸ”® æœªæ¥è§„åˆ’

### å³å°†æ”¯æŒçš„ç½‘ç»œ
- **Polygon**: é’ˆå¯¹Polygonç½‘ç»œçš„ä¼˜åŒ–é…ç½®
- **Arbitrum**: Layer 2ç½‘ç»œä¼˜åŒ–ç­–ç•¥
- **Optimism**: OP Stackå…¼å®¹ä¼˜åŒ–

### è®¡åˆ’åŠŸèƒ½
- **åŠ¨æ€é…ç½®è°ƒæ•´**: è¿è¡Œæ—¶é…ç½®çƒ­æ›´æ–°
- **AIé©±åŠ¨ä¼˜åŒ–**: åŸºäºå†å²æ•°æ®çš„æ™ºèƒ½è°ƒä¼˜
- **å¤šç½‘ç»œè´Ÿè½½å‡è¡¡**: è·¨ç½‘ç»œæ™ºèƒ½è·¯ç”±

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ•…éšœæ’é™¤éƒ¨åˆ†
2. è¿è¡ŒéªŒè¯è„šæœ¬è¯Šæ–­
3. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
4. æäº¤Issueåˆ°é¡¹ç›®ä»“åº“

---

**æ³¨æ„**: æ™ºèƒ½é…ç½®ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé…ç½®å¤‡ä»½ï¼Œç¡®ä¿å¯ä»¥éšæ—¶å›æ»šåˆ°åŸå§‹é…ç½®ã€‚